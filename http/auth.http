@baseUrl = http://localhost:8000/api/v1
@contentType = application/json

### Variables for testing
@username = alexdev
@password = Orboygsq@16
@email = alex.candido.dev@gmail.com

### Login with credentials
# @name login
POST {{baseUrl}}/auth/login_credentials/
Content-Type: {{contentType}}

{
    "username": "{{username}}",
    "password": "{{password}}"
}

### Store auth tokens from login response
@accessToken = {{login.response.body.access}}
@refreshToken = {{login.response.body.refresh}}

### Register new user
POST {{baseUrl}}/auth/register_credentials/
Content-Type: {{contentType}}

{
    "username": "{{username}}",
    "email": "{{email}}",
    "password1": "{{password}}",
    "password2": "{{password}}"
}

### Logout (requires authentication)
POST {{baseUrl}}/auth/logout/
Content-Type: {{contentType}}
Authorization: Bearer {{accessToken}}

{
    "refresh": "{{refreshToken}}"
}

### Forgot Password
POST {{baseUrl}}/auth/forgot_password/
Content-Type: {{contentType}}

{
    "email": "{{email}}"
}

### Reset Password (requires reset token)
POST {{baseUrl}}/auth/reset_password/
Content-Type: {{contentType}}

{
    "token": "MTA0-cp15xj-2c841e29987f5a99ef5581b6f9ba1cf7",
    "password": "NovaSenha@123"
}

### Change Password (requires authentication)
POST {{baseUrl}}/auth/change_password/
Content-Type: {{contentType}}
Authorization: Bearer {{accessToken}}

{
    "new_password1": "NovaSenha@123",
    "new_password2": "NovaSenha@123"
}

### Get new Access Token using Refresh Token
POST {{baseUrl}}/auth/access_token/
Content-Type: {{contentType}}

{
    "refresh": "{{refreshToken}}"
}

### Get new Refresh Token using Access Token (optional, depending on policy)
POST {{baseUrl}}/auth/refresh_token/
Content-Type: {{contentType}}

{
    "refresh": "{{refreshToken}}"
}

### Verify token validity
POST {{baseUrl}}/auth/verify_token/
Content-Type: {{contentType}}

{
    "token": "{{accessToken}}"
}

### Resend email verification
POST {{baseUrl}}/auth/resend_verification_email/
Content-Type: {{contentType}}

{
    "email": "{{email}}"
}

### Confirm email verification
POST {{baseUrl}}/auth/verify_email/
Content-Type: {{contentType}}

{
    "key": "confirmacao-email-token-aqui"
}

### Get or update authenticated user's details
GET {{baseUrl}}/auth/user/
Content-Type: {{contentType}}
Authorization: Bearer {{accessToken}}

### Update user details
PATCH {{baseUrl}}/auth/user/
Content-Type: {{contentType}}
Authorization: Bearer {{accessToken}}

{
    "first_name": "Alex",
    "last_name": "Candido"
}
